<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research & Publications | Aminollah Khormali, Ph.D.</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;700&family=Playfair+Display:ital,wght@1,500;1,600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --glass: rgba(10, 25, 47, 0.7); 
            --border: rgba(212, 175, 55, 0.3);
            --text-dark: #FFFFFF;
            --text-muted: #cbd5e1;
            --royal-blue: #0A192F; 
            --deep-navy: #020c1b;
            --gold-bright: #F9D423;
            --gold-metallic: #D4AF37;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(160deg, var(--deep-navy) 0%, var(--royal-blue) 45%, #050a14 100%);
            background-attachment: fixed;
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: var(--text-dark);
            overflow-x: hidden;
            min-height: 100vh;
        }

        .ambient-canvas { position: fixed; inset: 0; z-index: -1; }
        .liquid-blob {
            position: absolute;
            width: 80vw; height: 80vw;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.04) 0%, transparent 70%);
            filter: blur(120px);
            border-radius: 50%;
            animation: drift 20s infinite alternate ease-in-out;
        }
        @keyframes drift { from { transform: translate(-10%, -10%); } to { transform: translate(10%, 10%); } }

        .container { max-width: 1100px; margin: 0 auto; padding: 60px 20px; }

        .page-header { text-align: center; margin-bottom: 40px; }
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(32px, 5vw, 54px);
            font-style: italic;
            margin-bottom: 30px;
            background: linear-gradient(to right, #ffffff, var(--gold-bright), #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-gold {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            padding: 18px 40px;
            background: linear-gradient(45deg, #BF953F, #FCF6BA, #B38728, #FBF5B7, #AA771C);
            background-size: 400% 400%;
            animation: goldPulse 8s ease infinite;
            color: #000;
            border-radius: 20px;
            font-weight: 800;
            font-size: 12px;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: 0.4s;
            border: none;
            cursor: pointer;
        }
        @keyframes goldPulse { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* --- NEW: RESEARCH DOMAINS SECTION --- */
        .topic-scroller {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 60px;
        }

        .topic-card {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 25px 20px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
        }

        .topic-card:hover {
            background: rgba(212, 175, 55, 0.1);
            border-color: var(--gold-bright);
            transform: translateY(-8px);
        }

        .topic-card h4 {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--gold-bright);
            margin-bottom: 15px;
            min-height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .topic-stats {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 12px;
            border-radius: 12px;
        }

        .stat-value {
            font-family: 'Playfair Display', serif;
            font-size: 18px;
            font-weight: 700;
            color: #fff;
        }

        .stat-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
        }
        /* --- END NEW SECTION --- */

        .analytics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 60px;
        }

        .chart-card {
            background: var(--glass);
            backdrop-filter: blur(40px) saturate(180%);
            border: 1px solid var(--border);
            border-radius: 35px;
            padding: 40px;
            height: 400px;
        }
        .chart-card h3 {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 4px;
            color: var(--gold-metallic);
            margin-bottom: 25px;
        }

        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 50px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 25px;
        }

        .filter-bar input, .filter-bar select {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            color: white;
            padding: 15px 25px;
            border-radius: 18px;
            flex: 1;
            font-family: inherit;
        }

        .articles-list { display: flex; flex-direction: column; gap: 40px; }
        
        .article-card {
            display: grid;
            grid-template-columns: 320px 1fr;
            background: var(--glass);
            backdrop-filter: blur(40px);
            border: 1px solid var(--border);
            border-radius: 35px;
            overflow: hidden;
            transition: 0.4s;
        }

        .article-card:hover { transform: translateY(-5px); border-color: var(--gold-bright); }

        .article-img-wrapper { position: relative; overflow: hidden; background: #020c1b;}
        .article-img-wrapper img { width: 100%; height: 100%; object-fit: cover; opacity: 0.7; }

        .article-content { padding: 45px; display: flex; flex-direction: column; justify-content: center; }
        .article-meta { font-size: 10px; font-weight: 700; letter-spacing: 3px; color: var(--gold-bright); text-transform: uppercase; margin-bottom: 12px; }
        .article-title { font-family: 'Playfair Display', serif; font-size: 28px; line-height: 1.2; margin-bottom: 8px; font-style: italic; }
        .article-venue { font-size: 14px; color: var(--gold-metallic); margin-bottom: 20px; opacity: 0.9; }

        .abstract-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            padding-bottom: 15px;
            position: relative;
        }

        .abstract-details { flex: 1; }

        .abstract-details summary {
            list-style: none;
            cursor: pointer;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-muted);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: 0.3s;
        }
        
        .abstract-details summary:hover { color: var(--gold-bright); }
        .abstract-details summary::-webkit-details-marker { display: none; }
        .abstract-details summary::before { content: '＋'; color: var(--gold-bright); font-weight: bold; }
        .abstract-details[open] summary::before { content: '－'; }

        .citation-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            font-weight: 800;
            color: #000;
            background: var(--gold-bright);
            padding: 6px 14px;
            border-radius: 100px;
            text-transform: uppercase;
            letter-spacing: 1px;
            white-space: nowrap;
            margin-left: 20px;
        }

        .article-abstract { 
            font-size: 15px; 
            color: var(--text-muted); 
            line-height: 1.8; 
            padding: 20px 0 10px 20px;
            margin-top: 10px;
            border-left: 2px solid var(--gold-metallic);
            animation: slideDown 0.3s ease-out;
            width: 100%;
        }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        .box-btn {
            display: inline-flex; align-items: center; justify-content: space-between;
            padding: 16px 30px; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border);
            border-radius: 15px; text-decoration: none; color: #fff; font-size: 12px; font-weight: 700;
            width: fit-content; min-width: 200px; text-transform: uppercase; transition: 0.3s;
        }
        .box-btn:hover { background: var(--gold-metallic); color: #000; }

        @media (max-width: 950px) {
            .analytics-grid { grid-template-columns: 1fr; }
            .article-card { grid-template-columns: 1fr; }
            .article-img-wrapper { height: 250px; }
            .filter-bar { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="ambient-canvas"><div class="liquid-blob"></div></div>

<div class="container">
    <header class="page-header">
        <h1>Research <i>Insight</i></h1>
        <a href="https://scholar.google.com/citations?user=nJtAVTgAAAAJ" target="_blank" class="btn-gold">
            Google Scholar Profile
        </a>
    </header>

    <div class="topic-scroller" id="topicImpactGrid">
        </div>

    <div class="analytics-grid">
        <div class="chart-card"><h3>Publication Velocity</h3><canvas id="pubChart"></canvas></div>
        <div class="chart-card"><h3>Citation Influence</h3><canvas id="citeChart"></canvas></div>
    </div>

    <div class="filter-bar">
        <input type="text" id="searchInput" placeholder="Search title or abstract..." onkeyup="filterArticles()">
        <select id="yearFilter" onchange="filterArticles()">
            <option value="all">All Years</option>
        </select>
        <select id="fieldFilter" onchange="filterArticles()">
            <option value="all">All Topics</option>
        </select>
    </div>

    <div class="articles-list" id="articlesList"></div>
</div>

<script>
    const years = ['2019', '2020', '2021', '2022', '2023', '2024'];
    
    window.onload = async () => {
        initCharts();
        
        try {
            const response = await fetch('publications.json');
            const publications = await response.json();
            
            // Populate Dynamic Sections
            setupFilters(publications);
            renderTopicImpact(publications);
            renderArticles(publications);
            
        } catch (error) {
            console.error('Error loading publications:', error);
            document.getElementById('articlesList').innerHTML = '<p style="text-align:center">Error loading publications. Please ensure publications.json is present.</p>';
        }
    };

    function renderTopicImpact(publications) {
        const container = document.getElementById('topicImpactGrid');
        const metrics = {};
        
        // Count papers and citations per domain
        publications.forEach(p => {
            if (!metrics[p.field]) {
                metrics[p.field] = { name: p.fieldType, papers: 0, citations: 0 };
            }
            metrics[p.field].papers += 1;
            metrics[p.field].citations += parseInt(p.citations || 0);
        });

        const sortedKeys = Object.keys(metrics).slice(0, 5); // Focus on top 5

        container.innerHTML = sortedKeys.map(key => `
            <div class="topic-card" onclick="quickFilter('${key}')">
                <h4>${metrics[key].name}</h4>
                <div class="topic-stats">
                    <div class="stat-item">
                        <span class="stat-label">Papers</span>
                        <span class="stat-value">${metrics[key].papers}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Citations</span>
                        <span class="stat-value">${metrics[key].citations}</span>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function setupFilters(publications) {
        const yearSelect = document.getElementById('yearFilter');
        const fieldSelect = document.getElementById('fieldFilter');
        
        const uniqueYears = [...new Set(publications.map(p => p.year))].sort((a,b) => b-a);
        const fieldMap = new Map();
        publications.forEach(p => fieldMap.set(p.field, p.fieldType));

        uniqueYears.forEach(y => yearSelect.innerHTML += `<option value="${y}">${y}</option>`);
        fieldMap.forEach((name, code) => fieldSelect.innerHTML += `<option value="${code}">${name}</option>`);
    }

    function quickFilter(fieldCode) {
        document.getElementById('fieldFilter').value = fieldCode;
        filterArticles();
        document.getElementById('fieldFilter').scrollIntoView({ behavior: 'smooth' });
    }

    function initCharts() {
        const pCtx = document.getElementById('pubChart').getContext('2d');
        new Chart(pCtx, { 
            type: 'bar', 
            data: { labels: years, datasets: [{ data: [4, 6, 5, 8, 5, 7], backgroundColor: '#F9D423' }] }, 
            options: { maintainAspectRatio: false, plugins: { legend: { display: false } } } 
        });
        const cCtx = document.getElementById('citeChart').getContext('2d');
        new Chart(cCtx, { 
            type: 'line', 
            data: { labels: years, datasets: [{ data: [120, 380, 650, 920, 1150, 1420], borderColor: '#F9D423', fill: false }] }, 
            options: { maintainAspectRatio: false, plugins: { legend: { display: false } } } 
        });
    }

    function renderArticles(publications) {
        const container = document.getElementById('articlesList');
        container.innerHTML = publications.map(pub => `
            <div class="article-card" data-year="${pub.year}" data-field="${pub.field}">
                <div class="article-img-wrapper">
                    <img src="${pub.image}" alt="Publication image" onerror="this.src='https://via.placeholder.com/400x300/020c1b/D4AF37?text=Research'">
                </div>
                <div class="article-content">
                    <div class="article-meta">${pub.year} • ${pub.fieldType}</div>
                    <h2 class="article-title">${pub.title}</h2>
                    <div class="article-venue">${pub.venue}</div>
                    <div class="abstract-header">
                        <details class="abstract-details">
                            <summary>View Abstract</summary>
                            <div class="article-abstract">${pub.abstract}</div>
                        </details>
                        <div class="citation-badge">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm0-8h-2V7h2v2zm4 8h-2V7h2v10z"/></svg>
                            ${pub.citations} Citations
                        </div>
                    </div>
                    <a href="${pub.link}" target="_blank" class="box-btn">Read Publication <span>→</span></a>
                </div>
            </div>
        `).join('');
    }

    function filterArticles() {
        const searchText = document.getElementById('searchInput').value.toLowerCase();
        const selectedYear = document.getElementById('yearFilter').value;
        const selectedField = document.getElementById('fieldFilter').value;
        
        document.querySelectorAll('.article-card').forEach(card => {
            const title = card.querySelector('.article-title').innerText.toLowerCase();
            const year = card.dataset.year;
            const field = card.dataset.field;

            const matchesKeyword = title.includes(searchText);
            const matchesYear = selectedYear === 'all' || year === selectedYear;
            const matchesField = selectedField === 'all' || field === selectedField;

            card.style.display = (matchesKeyword && matchesYear && matchesField) ? 'grid' : 'none';
        });
    }
</script>

</body>
</html>
